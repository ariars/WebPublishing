var TabManager=function($){function TabManager(option){this._option=option,this._$tabArea=window.$topArea.find(".tab-area"),this._$tabContainer=$("#tab"),this._$moreTab=this._$tabContainer.find(".more-tab"),this._$moreTabLayer=this._$tabContainer.next(".tab-list-more"),this._tabCount=0,this._maxTabSize=10,this._titleTab,this._tabs={},this._tabTypeCount={},this._tabNameCount={},this._setPanels={},this._resizeTab=function(addChk){this._$moreTab.hide(),this._$moreTabLayer.hide(),this._$tabContainer.children(".more-tab").before(this._$moreTabLayer.find("ul > li"));var tabAreaWidth=$(window).width()-window.$lnbArea.width()-25,$tabs=this._$tabContainer.children("li:not(.more-tab)");$tabs.find("button").removeClass("del02").addClass("del");var tabSumWidth=this._$moreTab.width()+22,_this=this;$tabs.each(function(i,tg){var $tab=$(tg);tabSumWidth+=$tab.width(),tabAreaWidth<=tabSumWidth&&($tab.find("button").removeClass("del").addClass("del02"),_this._$moreTabLayer.children().append($tab),_this._$moreTab.show())}),this._$moreTabLayer.css({left:this._$moreTab.position().left-this._$moreTabLayer.width()+this._$moreTab.width()})},this._setPosition=function(id,$cloneEl){0==id&&this._$tabContainer.prepend($cloneEl);this._$tabContainer.find(".default").toArray();for(var i=id-1;i>=0;i--){var $tab=this._$tabContainer.find(".pos"+i);$tab.size()>0&&$tab.after($cloneEl);break}},this.init()}return TabManager.prototype.init=function(){$(window).bind("resize.tab",this,function(e){e.data._resizeTab()}),$(document).bind("click.tab",this,function(e){e.stopPropagation(),e.data._$moreTabLayer.hide()}),this._$moreTab.bind("click",this,function(e){e.preventDefault(),e.stopPropagation(),e.data._$moreTabLayer.fadeToggle(0)})},TabManager.prototype.changeTab=function(className,clickTab){this._$tabContainer.find(".current").removeClass("current"),this._$moreTabLayer.find(".current").removeClass("current"),clickTab||(clickTab=this._$tabArea.find("."+className+"> a")),clickTab.focus(),$(clickTab).parent().addClass("current"),$(clickTab).parents("div").hasClass("tab-list-more")?this._$moreTab.addClass("current"):(clickIdx=$(clickTab).parent().index(),this._$moreTab.removeClass("current")),this._option.changeTab(className)},TabManager.prototype.addTab=function(option){var maxCount=0;for(var prop in this._tabTypeCount)if(!(tab=this._$tabContainer.find("."+prop)).hasClass("default")&&(maxCount+=this._tabTypeCount[prop],option.useCount&&maxCount==this._maxTabSize))return void this._option.maxTab();this._$tabContainer.find(".current").removeClass("current"),this._$moreTabLayer.find(".current").removeClass("current"),this._tabCount++;var _this=this,titleVal="",classNameVal="";if(option.useCount)this._tabTypeCount[option.className]?(this._tabTypeCount[option.className]++,this._tabNameCount[option.className]++,function(){var bool=!1;return _this._$tabContainer.children().each(function(){var classArr=$(this).attr("class").split(" ");for(var i in classArr)classArr[i].indexOf(option.className)>-1&&(bool=!0)}),bool}()||(this._tabTypeCount[option.className]=1,this._tabNameCount[option.className]=1)):(this._tabTypeCount[option.className]=1,this._tabNameCount[option.className]=1),titleVal=option.title+this._tabNameCount[option.className],classNameVal=option.className+this._tabCount;else{if(this._tabTypeCount[option.className])return void this.changeTab(option.className);this._tabTypeCount[option.className]=1,this._tabNameCount[option.className]=1,titleVal=option.title,classNameVal=option.className}if(option.setPanel){for(var prop in _this._setPanels)var isPanel=_this._setPanels[option.setPanel];if(isPanel)return this._tabTypeCount[option.className]--,this._tabNameCount[option.className]--,void _this.changeTab(isPanel);_this._setPanels[option.setPanel]=classNameVal}var tab=new Tab({title:titleVal,className:classNameVal,addClass:this._option.addClass,originClassName:option.className,useCount:option.useCount,useDelete:option.useDelete,useDeleteCallback:option.useDeleteCallback,useSubLink:option.useSubLink,subLinkData:option.subLinkData,setPosition:option.setPosition,data:option.data,parent:this});this._tabs[classNameVal]=tab,this._option.addTab(classNameVal,option.className,option.sendData);var $cloneEl=tab.getEl();0==this._$tabContainer.children(".default").size()?this._$tabContainer.prepend($cloneEl):this._$tabContainer.children(".default:last").after($cloneEl),0==option.setPosition&&(this._titleTab&&this.removeTab(this._titleTab),this._titleTab=tab),option.setPosition>=0&&this._setPosition(option.setPosition,$cloneEl),this._resizeTab(!0),$cloneEl.not(".bt").find("a").trigger("click",$cloneEl.find("a"))},TabManager.prototype.removeTab=function(tab){tab.getEl().children("a");tab.getEl().remove();var className=tab.getClassName();if(this._tabs[className]=null,delete this._tabs[className],tab.getUseCount()){var cnt=parseInt(this._tabTypeCount[tab.getOriginClassName()])-1;this._tabTypeCount[tab.getOriginClassName()]=cnt}else delete this._tabTypeCount[tab.getClassName()],delete this._tabNameCount[tab.getClassName()];this._option.removeTab(tab.getClassName());for(var prop in this._setPanels)this._setPanels[prop]==tab.getClassName()&&delete this._setPanels[prop];var $current=this._$tabArea.find(".current:not(.more-tab)");if(0==$current.size()){var $lastTab=this._$tabContainer.children(":not(.default, .more-tab, .bt):eq(0)");0==$lastTab.size()&&($lastTab=this._$tabContainer.children(".default:last")),$lastTab.size()>0&&this.changeTab($lastTab.not(".bt").attr("class").split(" ")[0])}this._resizeTab(),$current.find("a").focus()},TabManager.prototype.removeCallback=function(tab){this._option.removeCallback(tab)},TabManager.prototype.refreshTab=function(className,sendData){this._option.refreshTab(className,sendData),this.changeTab(className)},TabManager.prototype.changeTabName=function(className,tabName,tabTitle){this._tabs[className].setTitle(tabName,tabTitle)},TabManager.prototype.selectTab=function(className){this._tabs[className].click()},TabManager.prototype.findCurrentTab=function(){for(var prop in this._tabs){var tab=this._tabs[prop];if(tab.getEl().hasClass("current"))return tab}},TabManager.prototype.getTabLists=function(){return this._tabs},TabManager}(jQuery);
//# sourceMappingURL=../maps/tab/TabManager.js.map
